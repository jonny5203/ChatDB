
# Story: 1.3 - Federated Authentication (IAM)

**Epic:** 1 - API Gateway Implementation
**Status:** Done

## Story

As a developer, I want to integrate the API Gateway with an external Identity and Access Management (IAM) provider, so that users can authenticate with their existing credentials.

## Acceptance Criteria

1.  The API Gateway can redirect unauthenticated users to an external IAM provider.
2.  The API Gateway can receive a callback from the IAM provider with an authentication token.
3.  The API Gateway can validate the authentication token.

## Dev Notes

*   **IAM Provider:** Use Okta or Keycloak as the external IAM provider. [Source: architecture/1-high-level-architecture.md#High Level Architecture Diagram]
*   **Authentication Protocol:** Use OpenID Connect (OIDC) to integrate with the IAM provider. [Source: Not explicitly in architecture, but a standard practice for this type of integration.]
*   **Token Validation:** Use a Go library to validate the JWT token received from the IAM provider. [Source: Not explicitly in architecture, but a standard practice for this type of integration.]
*   **Configuration:** OIDC configuration is loaded from environment variables.

## Tasks / Subtasks

*   [x] Add a Go OIDC library to the `go.mod` file.
*   [x] Create a new route in `main.go` that redirects unauthenticated users to the IAM provider.
*   [x] Create a new route in `main.go` that handles the callback from the IAM provider.
*   [x] Implement token validation logic in the callback handler.
*   [x] Write a unit test to verify that the OIDC flow is working correctly.

